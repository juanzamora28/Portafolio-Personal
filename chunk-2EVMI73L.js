import{c as H,d as et,e as ot,f as at}from"./chunk-NKRFROHD.js";function K(){for(var n=0,t=arguments.length,r={},e;n<t;++n){if(!(e=arguments[n]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new F(r)}function F(n){this._=n}function ut(n,t){return n.trim().split(/^|\s+/).map(function(r){var e="",o=r.indexOf(".");if(o>=0&&(e=r.slice(o+1),r=r.slice(0,o)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:e}})}function ft(n,t){for(var r=0,e=n.length,o;r<e;++r)if((o=n[r]).name===t)return o.value}function J(n,t,r){for(var e=0,o=n.length;e<o;++e)if(n[e].name===t){n[e]=it,n=n.slice(0,e).concat(n.slice(e+1));break}return r!=null&&n.push({name:t,value:r}),n}var it,Q,U=H(()=>{"use strict";it={value:function(){}};F.prototype=K.prototype={constructor:F,on:function(n,t){var r=this._,e=ut(n+"",r),o,l=-1,c=e.length;if(arguments.length<2){for(;++l<c;)if((o=(n=e[l]).type)&&(o=ft(r[o],n.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++l<c;)if(o=(n=e[l]).type)r[o]=J(r[o],n.name,t);else if(t==null)for(o in r)r[o]=J(r[o],n.name,null);return this},copy:function(){var n={},t=this._;for(var r in t)n[r]=t[r].slice();return new F(n)},call:function(n,t){if((o=arguments.length-2)>0)for(var r=new Array(o),e=0,o,l;e<o;++e)r[e]=arguments[e+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(l=this._[n],e=0,o=l.length;e<o;++e)l[e].value.apply(t,r)},apply:function(n,t,r){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var e=this._[n],o=0,l=e.length;o<l;++o)e[o].value.apply(t,r)}};Q=K});var V={};ot(V,{dispatch:()=>Q});var Z=H(()=>{"use strict";U()});var zt=et((bt,d)=>{var lt=(Z(),at(V)).dispatch,B=Math.PI/180,st={archimedean:j,rectangular:Mt},R=64,O=2048;d.exports=function(){var n=[256,256],t=ct,r=ht,e=xt,o=$,l=$,c=yt,v=vt,M=j,S=[],I=1/0,g=lt("word","end"),h=null,T=Math.random,i={},D=It;i.canvas=function(a){return arguments.length?(D=k(a),i):D},i.start=function(){var a=_(D()),f=St((n[0]>>5)*n[1]),x=null,m=S.length,z=-1,b=[],w=S.map(function(s,u){return s.text=t.call(this,s,u),s.font=r.call(this,s,u),s.style=o.call(this,s,u),s.weight=l.call(this,s,u),s.rotate=c.call(this,s,u),s.size=~~e.call(this,s,u),s.padding=v.call(this,s,u),s}).sort(function(s,u){return u.size-s.size});return h&&clearInterval(h),h=setInterval(q,0),q(),i;function q(){for(var s=Date.now();Date.now()-s<I&&++z<m&&h;){var u=w[z];u.x=n[0]*(T()+.5)>>1,u.y=n[1]*(T()+.5)>>1,mt(a,u,w,z),u.hasText&&P(f,u,x)&&(b.push(u),g.call("word",i,u),x?gt(x,u):x=[{x:u.x+u.x0,y:u.y+u.y0},{x:u.x+u.x1,y:u.y+u.y1}],u.x-=n[0]>>1,u.y-=n[1]>>1)}z>=m&&(i.stop(),g.call("end",i,b,x))}},i.stop=function(){h&&(clearInterval(h),h=null);for(let a of S)delete a.sprite;return i};function _(a){let f=a.getContext("2d",{willReadFrequently:!0});a.width=a.height=1;let x=Math.sqrt(f.getImageData(0,0,1,1).data.length>>2);return a.width=(R<<5)/x,a.height=O/x,f.fillStyle=f.strokeStyle="red",{context:f,ratio:x}}function P(a,f,x){for(var m=[{x:0,y:0},{x:n[0],y:n[1]}],z=f.x,b=f.y,w=Math.sqrt(n[0]*n[0]+n[1]*n[1]),q=M(n),s=T()<.5?1:-1,u=-s,E,y,p;(E=q(u+=s))&&(y=~~E[0],p=~~E[1],!(Math.min(Math.abs(y),Math.abs(p))>=w));)if(f.x=z+y,f.y=b+p,!(f.x+f.x0<0||f.y+f.y0<0||f.x+f.x1>n[0]||f.y+f.y1>n[1])&&(!x||wt(f,x))&&!pt(f,a,n[0])){for(var tt=f.sprite,C=f.width>>5,L=n[0]>>5,X=f.x-(C<<4),Y=X&127,nt=32-Y,rt=f.y1-f.y0,G=(f.y+f.y0)*L+(X>>5),W,N=0;N<rt;N++){W=0;for(var A=0;A<=C;A++)a[G+A]|=W<<nt|(A<C?(W=tt[N*C+A])>>>Y:0);G+=L}return!0}return!1}return i.timeInterval=function(a){return arguments.length?(I=a??1/0,i):I},i.words=function(a){return arguments.length?(S=a,i):S},i.size=function(a){return arguments.length?(n=[+a[0],+a[1]],i):n},i.font=function(a){return arguments.length?(r=k(a),i):r},i.fontStyle=function(a){return arguments.length?(o=k(a),i):o},i.fontWeight=function(a){return arguments.length?(l=k(a),i):l},i.rotate=function(a){return arguments.length?(c=k(a),i):c},i.text=function(a){return arguments.length?(t=k(a),i):t},i.spiral=function(a){return arguments.length?(M=st[a]||a,i):M},i.fontSize=function(a){return arguments.length?(e=k(a),i):e},i.padding=function(a){return arguments.length?(v=k(a),i):v},i.random=function(a){return arguments.length?(T=a,i):T},i.on=function(){var a=g.on.apply(g,arguments);return a===g?i:a},i};function ct(n){return n.text}function ht(){return"serif"}function $(){return"normal"}function xt(n){return Math.sqrt(n.value)}function yt(){return(~~(random()*6)-3)*30}function vt(){return 1}function mt(n,t,r,e){if(!t.sprite){var o=n.context,l=n.ratio;o.clearRect(0,0,(R<<5)/l,O/l);var c=0,v=0,M=0,S=r.length;for(--e;++e<S;){t=r[e],o.save(),o.font=t.style+" "+t.weight+" "+~~((t.size+1)/l)+"px "+t.font;let u=o.measureText(t.text),E=-Math.floor(u.width/2),y=(u.width+1)*l,p=t.size<<1;if(t.rotate){var I=Math.sin(t.rotate*B),g=Math.cos(t.rotate*B),h=y*g,T=y*I,i=p*g,D=p*I;y=Math.max(Math.abs(h+D),Math.abs(h-D))+31>>5<<5,p=~~Math.max(Math.abs(T+i),Math.abs(T-i))}else y=y+31>>5<<5;if(p>M&&(M=p),c+y>=R<<5&&(c=0,v+=M,M=0),v+p>=O)break;o.translate((c+(y>>1))/l,(v+(p>>1))/l),t.rotate&&o.rotate(t.rotate*B),o.fillText(t.text,E,0),t.padding&&(o.lineWidth=2*t.padding,o.strokeText(t.text,E,0)),o.restore(),t.width=y,t.height=p,t.xoff=c,t.yoff=v,t.x1=y>>1,t.y1=p>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,c+=y}for(var _=o.getImageData(0,0,(R<<5)/l,O/l).data,P=[];--e>=0;)if(t=r[e],!!t.hasText){for(var a=t.width,f=a>>5,x=t.y1-t.y0,m=0;m<x*f;m++)P[m]=0;if(c=t.xoff,c==null)return;v=t.yoff;for(var z=0,b=-1,w=0;w<x;w++){for(var m=0;m<a;m++){var q=f*w+(m>>5),s=_[(v+w)*(R<<5)+(c+m)<<2]?1<<31-m%32:0;P[q]|=s,z|=s}z?b=w:(t.y0++,x--,w--,v++)}t.y1=t.y0+b,t.sprite=P.slice(0,(t.y1-t.y0)*f)}}}function pt(n,t,r){r>>=5;for(var e=n.sprite,o=n.width>>5,l=n.x-(o<<4),c=l&127,v=32-c,M=n.y1-n.y0,S=(n.y+n.y0)*r+(l>>5),I,g=0;g<M;g++){I=0;for(var h=0;h<=o;h++)if((I<<v|(h<o?(I=e[g*o+h])>>>c:0))&t[S+h])return!0;S+=r}return!1}function gt(n,t){var r=n[0],e=n[1];t.x+t.x0<r.x&&(r.x=t.x+t.x0),t.y+t.y0<r.y&&(r.y=t.y+t.y0),t.x+t.x1>e.x&&(e.x=t.x+t.x1),t.y+t.y1>e.y&&(e.y=t.y+t.y1)}function wt(n,t){return n.x+n.x1>t[0].x&&n.x+n.x0<t[1].x&&n.y+n.y1>t[0].y&&n.y+n.y0<t[1].y}function j(n){var t=n[0]/n[1];return function(r){return[t*(r*=.1)*Math.cos(r),r*Math.sin(r)]}}function Mt(n){var t=4,r=t*n[0]/n[1],e=0,o=0;return function(l){var c=l<0?-1:1;switch(Math.sqrt(1+4*c*l)-c&3){case 0:e+=r;break;case 1:o+=t;break;case 2:e-=r;break;default:o-=t;break}return[e,o]}}function St(n){for(var t=[],r=-1;++r<n;)t[r]=0;return t}function It(){return document.createElement("canvas")}function k(n){return typeof n=="function"?n:function(){return n}}});export default zt();
